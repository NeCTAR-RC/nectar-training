<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel='shortcut icon' href='/images/icon.png' />

  <title>Launching and Connecting</title>
  <meta name="description" content="Nectar National Training Resources
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://training.nectar.org.au/package07/sections/ephemeralStorage.html">
  <link rel="alternate" type="application/rss+xml" title="Nectar Training" href="http://training.nectar.org.au/feed.xml" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61845992-2', 'auto');
  ga('send', 'pageview');
</script>
</head>


  <body>

    <header class="site-header">
<div class="nec-header">
  <div class="header-top">
    <div class="header-top-page">
      <div class="nect-login">
        <a href="https://support.nectar.org.au/support/home">Support</a>
        <a href="http://cloud.nectar.org.au/contact/" class="new-tick">Contact</a>
        <b><a href="https://dashboard.rc.nectar.org.au/"><b>Login</b></a></b>
      </div>
    </div>
  </div>

  <div class="header-main">
    <div class="header-main-page">
      <div class="logo-nect">
        <img src='/images/nectar_cloud_logo.jpg' alt="Nectar" height="43", width"248">
      </div>
      <div class="menu-nect">
        
          <a href="/" class="selected">Self-paced Training</a>
          <a href="/for-trainers.html">Resources for Trainers</a>
        
      </div>
    </div>
  </div>

</div>

<div class="normal-block">
  <div class="normal-block-page">
    
      <h3>Self-paced Training</h3>
    
  </div>
</div>

</header>


    <div class="page-content">
      <div class="wrapper">
          <!-- 
    Preprocessing: Determine which part number this is. To avoid having to set numbers 
    manually on each page, determine this here by the file name. 
    -->
  
  
  
  
  

  
  
      
  

  
  
  
  
  
  	
  	
		
		
			
		
		
	
		
		
			
		
		
	
		
		
			
		
		
	
		
		
			
		
		
	
		
		
			
		
		
	
		
		
			
		
		
	
		
		
		
	
		
		
		
	
		
		
		
	
		
		
		
	
		
		
			
		
		
	
		
		
			
		
		
	
		
		
			
		
		
	
		
		
		
			
			
			
  	<!-- If we are not in the main hierarchy, we may be looking at a file of one of the sub-categories -->
	
  



<div class="post">

  <header class="post-header">
    <h3>Module 7</h3>
    <h1>Launching and Connecting</h1>
  </header>

  

  <!--
    List of the individual parts of this module (so not all content gets crammed on one page).
    Rendering this list first is necessary 
  -->
  <p> Sections of this module:</p>
  
	
	
		
	 
		
		

		
		
		
			
			
      <a href="/package07/sections/index.html"> Introduction</a>
			
			<br/>
		
	
		
	 
		
		

		
		
		
			
			
      <a href="/package07/sections/createSSHKey.html"> Create a ssh key</a>
			
			<br/>
		
	
		
	 
		
		

		
		
		
			
			
      <a href="/package07/sections/launching.html"> Launching an instance</a>
			
			<br/>
		
	
		
	 
		
		

		
		
		
			
			
      <a href="/package07/sections/connectViaSSH.html"> Connect to the instance</a>
			
			<br/>
		
	
		
	 
		
		

		
		
		
			
			
      <a href="/package07/sections/firstSSHCommands.html"> Configuration and control</a>
			
			<br/>
		
	
		
	 
		
		

		
		
		
			
			
      <a href="/package07/sections/remoteDesktop.html"> Connect to a remote desktop</a>
			
			<br/>
		
	
		
	 
		
		

		
		
		
	
		
	 
		
		

		
		
		
	
		
	 
		
		

		
		
		
	
		
	 
		
		

		
		
		
	
		
	 
		
		

		
		
		
			
			
      <a href="/package07/sections/guiViaSSH.html"> Graphical Interfaces on the ssh terminal</a>
			
			<br/>
		
	
		
	 
		
		

		
		
		
			
			
      <a href="/package07/sections/enableWebServer.html"> Install a web server</a>
			
			<br/>
		
	
		
	 
		
			
		
		

		
		
			
		
		
			
			
      <a href="/package07/sections/manageStorage.html"> Managing storage</a>
			
			<br/>
		
	
		
	 
		
		

		
		
			
				
			
		
		
			
				 <b>
			
			
      <a href="/package07/sections/ephemeralStorage.html">&nbsp;&nbsp; On-instance storage</a>
			
				</b>
			
			<br/>
		
	
		
	 
		
		

		
		
			
				
			
		
		
			
			
      <a href="/package07/sections/objectStorage.html">&nbsp;&nbsp; Object storage</a>
			
			<br/>
		
	
		
	 
		
		

		
		
			
				
			
		
		
			
			
      <a href="/package07/sections/volumeStorage.html">&nbsp;&nbsp; Volume storage</a>
			
			<br/>
		
	
		
	 
		
		

		
		
			
				
			
		
		
			
			
      <a href="/package07/sections/copyFiles.html">&nbsp;&nbsp; Copying files across</a>
			
			<br/>
		
	
		
	 
		
		
			
		

		
		
		
			
			
      <a href="/package07/sections/summary.html"> Summary</a>
			
			<br/>
		
	
		
	 
		
		
			
		

		
		
		
			
			
      <a href="/package07/sections/appendices.html"> Appendix</a>
			
			<br/>
		
	
  <br/>


  <a href="/package07/sections/all.html" target="_blank">View all sections on one page (Printer friendly)</a>
  <br/>
  <br/>
  <h1> On-instance storage </h1>

   <!-- endif for pagedata_avail -->
  

  <!--
  Content of page
  -->
  <article class="post-content">
    
<p>On-Instance storage appears as two separate hard disks. For example, in the flavor <em>“m1.small”</em> (you selected the <em>flavor</em> when launching the instance), this is</p>

<ol>
  <li>
    <p>a <strong>primary disk</strong> (10GB) which is saved with snapshots you make of the instance (see Module 9 for details about snapshots), and</p>
  </li>
  <li>
    <p>a <strong>secondary disk</strong> (30GB) which appears as a second hard disk on your instance, and is <em>not</em> backed up with snapshots. You will have to back up your data separately, which is a topic we will discuss later in <a href="/package09/sections/index.html" title="Module 9">Module 9</a>.</p>
  </li>
</ol>

<p>The primary disk (1) is usually used for the operating system, you should not use it primarily to store data. Your “home directory” is also located within this disk space (when you log on with ssh, you start off in your “home directory” <em>/home/ubuntu/</em>). To store large and important files, you should use the secondary disk (2). The advantage of this disk, as opposed to the volume storage, is that you don’t have to create it separately: it already comes with your instance.
Depending on the flavor you choose, you can get up to 480GB of storage for the secondary disk.</p>

<p>To get access to the secondary disk, we will have to <em>“mount”</em> it first. <em>Mounting</em> is a technique which essentially makes your hard drive accessible to you at a certain location (in a folder). Usually, the secondary disk is available on your system path <em>/dev/vdb</em>. However this is a <em>device file</em>, so you cannot read files there as if it was a folder. For this, we have to <em>“mount”</em> <em>/dev/vdb</em> to a folder first.</p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>On some images, e.g. on the Ubuntu image we use, the device <em>/dev/vdb</em> will already have been mounted for you, most likely in the folder <em>/mnt</em>. However we will still go through the steps of how to mount a device to another folder (name it for example <em>/data</em>), in order to learn all steps involved in preparing storage. You will benefit from this knowledge when setting up the Volume storage.</p>

				</div>

<p>To see where your secondary disk is mounted (or <em>if</em> it is mounted), go to your <em>ssh terminal</em> and type:</p>

<p><code>mount | grep vdb</code></p>

<p>You may get output that looks similar to this:</p>
<div class="bgTerminal"><pre class="PreformatTerminal">ubuntu@myfirstinstance:~$ mount | grep vdb    
/dev/vdb on /mnt type ext3 (rw)</pre></div>
<p>This means that vdb is mounted on <em>mnt</em> and has the <em>ext3</em> file system with read (r) and write (w) permissions. If you don’t get an output at all, vdb is not mounted.</p>

<p>Alternatively, try this command to check the <em>mount point</em> and size of your disks:</p>

<p><code>sudo lsblk -l</code></p>

<p>This should give you an output similar to this:</p>

<div class="bgTerminal"><pre class="PreformatTerminal">ubuntu@myfirstinstance:~$ sudo lsblk -l 
NAME  MAJ:MIN   RM  SIZE  RO TYPE MOUNTPOINT 
vda   253:0     0   10G   0  disk             
vda1  253:1     0   10G   0  part        /
vdb   253:16    0   30G   0  disk        /mnt</pre></div>

<p>This tells us that we have two hard drives, <strong>vda</strong> and <strong>vdb</strong>, of sizes 10G and 30G respectively. The primary disk (<em>vda</em>) is further partitioned into a sub-disk called <em>vda1</em> (using the full 10G) and this is <em>mounted</em> under the <em>mountpoint “/”</em>. In Linux terms, this means this disk is used for the operating system. The secondary disk (vdb) has 30G and is mounted on <em>/mnt</em>. Many OS, for example Ubuntu, already have mounted the secondary disk, but it may also not be mounted yet, in which case nothing is specified under MOUNTPOINT.</p>

<p>If your disk <em>vdb</em> has already been mounted, take note of what is specified as <em>mount point</em> for it. Then, <strong>unmount</strong> the disk using the command:</p>

<p><code>sudo umount &lt;mount point&gt;</code></p>

<p>replacing &lt;mount point&gt; with your mount point. For example, if your disk was mounted on <em>/mnt</em>, do</p>

<p><code>sudo umount /mnt</code></p>

<p>You may also be interested in the <strong>file system type</strong> which your secondary drive is currently using.</p>

<div class="bgDefinition" style="min-height: 55px;">
					<img src="/images/glyphicons-352-book-open.png" alt="image" align="left" style="width:24px; height:22px;
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>A <strong>file system</strong> is used to control how how the storage of data (files, folders, etc.) is organized on a computer disk (hard disk, floppy disk, CDROM, etc.).</p>

<p>The large amounts of data on a hard drive needs to be organized, similar to a library of books which needs to be catalogued, otherwise books cannot be found efficiently. Libraries have developed standards to organise their books, and similarly, computer systems have. Windows uses the <em>vFat</em> or the <em>NTFS</em> systems, while Linux has others, e.g. <em>ext3</em> and <em>ext4</em> are current standards.</p>

<p>File systems have different properties, e.g. maximum file size or partition size that is supported, and whether they <em>journal</em> or not. A <em>journaling file system</em> is more reliable when it comes to data storage: it prevents inconsistency, and is much faster at file system checks than non-journaled file systems.</p>

<p>For more information about the different Linux file systems, refer to this
<a href="https://help.ubuntu.com/community/LinuxFilesystemsExplained">Ubuntu help page</a>.</p>

				</div>

<p>To find out which <em>file system type</em> your drives use, type:</p>

<p><code>sudo lsblk -f</code></p>

<p>which will print a different view of the information we have seen in the last command (because we use the <strong>-f</strong> option instead of <strong>-l</strong>). It should look similar to this:</p>

<div class="bgTerminal"><pre class="PreformatTerminal">ubuntu@myfirstinstance:~$ sudo lsblk -f
NAME     FSTYPE   LABEL        UUID               MOUNTPOINT 
vda                                                            
└─vda1   ext4                  1b85cad6-...       /           
vdb      ext3     ephemeral0   24cf7b45-77...</pre></div>

<p>From this, we can see that <em>vda1</em> is a <em>partition</em> of <em>vda</em>. We can also see that
<em>vda1</em> uses the file system type <em>ext4</em>, while <em>vdb</em> is formatted with <em>ext3</em>.</p>

<p>In the above example, the disk devices are available on the paths <em>/dev/vda</em>  and <em>/dev/vdb</em> (you have to put the <em>/dev/</em> before the disk name to get the path).</p>

<p>Follow these instructions below to set up your secondary hard disk. You should do this every time you start up a new instance and want to prepare the secondary disk for usage.</p>

<h3 id="step-1-formatting">Step 1. Formatting</h3>

<p>The first time you start up an instance, you may want to format the hard drive of your secondary disk to make sure you have the right <em>file system type</em> and start from a clean state.</p>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>Formatting <strong>erases all data</strong> that may already be on the hard disk. If you are working with a new instance, nothing of importance will be on it, e.g. only a default system <em>Lost+Found</em> folder, or something similar. You should only be careful with this step if you have used the disk before and have data on it. Then, you should <strong>back up</strong> this data or <strong>skip this step</strong> (if you skip this step, you will have to keep the file system which is already used on the disk).</p>

				</div>

<p>One way to format the drive with the <em>ext4</em> file system type is:</p>

<p><code>sudo mkfs.ext4 /dev/vdb</code></p>

<p>(if your secondary drive is at another path than <em>/dev/vdb</em>, which you have just found out before, you have to replace this here).</p>

<p>Confirm the formatting with <em>‘y’</em>. You should see the status message</p>

<div class="bgTerminal"><pre class="PreformatTerminal">Writing superblocks and filesystem accounting information:</pre></div>

<p>Wait a while until it says “done.”, and then your hard-drive is formatted.</p>

<p>Now, you may want to verify that you have formatted the drive with the ext4 file system. Again, use the command</p>

<p><code>sudo lsblk -f</code></p>

<p>which prints information similar to this:</p>

<div class="bgTerminal"><pre class="PreformatTerminal">ubuntu@myfirstinstance:~$ sudo lsblk -f
NAME    FSTYPE  LABEL       UUID               MOUNTPOINT  
vda                                                                 
└─vda1  ext4                1b85cad6-...       /            
vdb     ext4                24cf7b45-77...</pre></div>

<p>You should now see that <em>vdb</em> is formatted with <em>ext4</em>. Only <em>vda</em> is mounted on <em>”/”</em>, and this should stay this way, because the OS is saved under <em>”/”</em>.</p>

<p>We will <em>mount</em> the secondary drive in the next step.</p>

<h3 id="step-2-mounting">Step 2. Mounting</h3>

<p>You can now <em>mount</em> your hard drive, so you can access it. First, create a folder which will be used to access your data. For example, we can name it <em>/data</em>:</p>

<p><code>sudo mkdir /data</code></p>

<p>Then, mount it:</p>

<p><code>sudo mount /dev/vdb /data</code></p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>This will mount the disk if the type of file system can be guessed. 
Otherwise you may have to specify the file system type with the -t option, e.g.  <br />
<code>sudo mount /dev/vdb /data -t ext4.</code></p>

<p>If you did not create and format the Volume then you can look up the filesystem type:  <br />
<code>sudo parted -l</code></p>

				</div>

<p>This maps the device <em>dev/vdb</em> to the folder <em>/data</em>.
Now, your disk is mounted at <em>/data</em>, and you can add, remove and access files on your secondary disk at the path <em>/data</em>.</p>

<p>You can list the contents of this directory to see what is on your disk (alternatively, if you are using a remote desktop, you can open it in your file explorer. It should be displayed as a disk symbol in the left navigation panel of your file browser).</p>

<p><code>ls /data</code></p>

<p>You may see that there is a <em>Lost+Found</em> folder (this is a default system folder). If nothing is printed, you have no files there yet.</p>

<h3 id="step-3-write-permissions">Step 3. Write permissions</h3>

<p>By default, you do not have write permissions on the secondary drive. You can try to copy a file onto <em>/data</em>, but you will get an error message about write permissions (<em>Note:</em> This is <em>not</em> due to our folder not being located in our home directory). So we need to add our write permissions now.</p>

<p>First, find out which <em>user group</em> you belong to is. Type</p>

<p><code>id ubuntu</code></p>

<p>and find what is written behind <em>“gid=”</em>. This may be <em>gid=1000(ubuntu)</em>. So your <em>group name</em> is also <em>ubuntu</em> and has the ID <em>1000</em>.</p>

<p>Now, there are two options: You can 1) enable write permission only for yourself (your username <em>ubuntu</em>), or 2) for the <em>user group</em> you are in. This way, you can share the drive with other users that you may give access to your instance and who you put in the same user group. The instructions below detail what you need to do for both alternatives.</p>

<p>Option 1)</p>

<p><code>sudo chown ubuntu /data</code></p>

<p>Option 2)</p>

<p><code>sudo chgrp ubuntu /data</code>  <br />
<code>sudo chmod g+rwx /data</code></p>

<p>This should do it. You can now write and execute files from your secondary drive.</p>

<p>You will only need to do this once for the secondary drive on this instance.</p>

<h3 id="step-4-auto-mounting">Step 4. Auto-mounting</h3>

<p>Every time you reboot your machine, you have to <em>mount</em> (<strong><em>not</em></strong> format!) the secondary drive again (so only do Step 2 above, not Step 1). We can avoid this by <em>auto mounting</em> it. For this, we have to edit a file called <em>fstab</em>:</p>

<p><code>sudo nano /etc/fstab</code></p>

<p>Look for a line which starts with <em>/dev/vdb</em>. You may find one that looks like this:</p>

<div class="bgEdit"><pre class="PreformatEdit">/dev/vdb  /mnt    auto    defaults,nobootwait,comment=cloudconfig   0  2</pre></div>

<p>If you find such a line, this means your secondary hard disk is already automatically mounted at system start. On the Ubuntu distribution we are using in this course, this is the case: it is auto-mounted to the folder <em>/mnt</em>, as we can see in this line. If you find this line, you can edit it and just change the <em>/mnt *to */data</em>. If you cannot find this line, just add this line to the file at the bottom:</p>

<div class="bgEdit"><pre class="PreformatEdit">/dev/vdb   /data  auto   defaults,nobootwait   0  2</pre></div>

<p>Exit the nano file editor with <strong>Ctrl+X</strong> and confirm saving of the file with <em>‘Y’</em>. Next time you reboot your instance, you should already find your secondary drive in your folder <em>/data</em>, and you won’t need to do any of the Steps described here to access it.</p>


  </article>


  
  <!--
  Previous section / Next section links. Very simple design to start with.
  -->
  <p>
  
  	
    <a href="/package07/sections/manageStorage.html">Previous section</a>
  
  &nbsp; &nbsp; &nbsp;
  
  	
    <a href="/package07/sections/objectStorage.html">Next section</a>
  
  </p>
   <!-- endif for pagedata_avail -->

</div>

      </div>
    </div>

    <div style="background-color: #0E0E0E; padding: 20px 20px 20px 60px; color: white; font-size: 12px">
  <p>Copyright &copy;2015 NeCTAR</p>
  <img src="/images/NCRIS_PROVIDER_rev.png" alt="NCRIS_PROVIDER_rev" width="132" height="63" />
  <p><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png">
  This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a></p>
</div>


  </body>

</html>
