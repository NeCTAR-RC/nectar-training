<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel='shortcut icon' href='/images/icon.png' />

  <title>Beyond the Dashboard</title>
  <meta name="description" content="Nectar National Training Resources
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://training.nectar.org.au/package10/sections/all.html">
  <link rel="alternate" type="application/rss+xml" title="Nectar Training" href="http://training.nectar.org.au/feed.xml" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61845992-2', 'auto');
  ga('send', 'pageview');
</script>
</head>


  <body>
    <div class="page-content">
      <div class="wrapper">
        <p><a href="/"><img src="/images/nectar_cloud_logo.jpg" alt="Nectar"/></a></p>
        <h3>Module 10</h3>
        <h1>Beyond the Dashboard</h1>

        
<h2 id="introduction">Introduction</h2>

<p>This module is designed for advanced users who want to learn more about command line tools to control the NeCTAR resources. This can help to automate procedures, for example with scripts for backup processes. Worked examples of the OpenStack command line tool <em>openstack</em> are included in this Module.</p>

<p>The previous modules have covered all you need to know to get started with the Research Cloud — this module is going to show how all of this can be done using only a few command line tools.
If you are not comfortable with the command line, rest assured that you already have all knowledge required to work with the Cloud using the Dashboard and the other tools discussed in previous Modules. If you like using the command line to get things done, you will <em>love</em> the extra information given in this module!</p>

<p>The following topics are going to be covered:</p>

<ul>
  <li>Installation of OpenStack command line clients</li>
  <li>Launching and terminating an instance</li>
  <li>Taking snapshots of instances and relaunching from snapshots</li>
  <li>Creating and deleting volumes</li>
  <li>Making backups and taking snapshots of volumes</li>
  <li>Accessing the object store</li>
</ul>

<h3 id="videos">Videos</h3>

<p>The following videos go through most of the content in this module and offer a less in-depth description of the subject than the documentation does.</p>

<p><a href="https://www.youtube.com/watch?v=t1nuK45_h0M">https://www.youtube.com/watch?v=t1nuK45_h0M</a></p>

<p><a href="https://www.youtube.com/watch?v=4jrzt_fSzjo">https://www.youtube.com/watch?v=4jrzt_fSzjo</a></p>

<p><a href="https://www.youtube.com/watch?v=4_nWStMJw7Q">https://www.youtube.com/watch?v=4_nWStMJw7Q</a></p>

<h3 id="conventions">Conventions</h3>

<p>The notation throughout the training documents can be interpreted as follows:</p>

<p>Words in <em>italics</em> are used for names and terminology, e.g. name of a software, or name of a computing concept. It may also just emphasise a word in the traditional way. Quotations are also written in italics and are put in between quotatioin marks.</p>

<p>Words in <strong>bold</strong> are used to highlight words which identify important concepts of a paragraph, to make it easier for users to skim through the text to find a paragraph which explains a certain idea, concept or technology.</p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p><strong>Additional information</strong> which is optional to read is displayed in <em>info boxes</em> like this one.</p>

				</div>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p><strong>Important information</strong> is displayed in boxes like this one.</p>

				</div>

<div class="bgDefinition" style="min-height: 55px;">
					<img src="/images/glyphicons-352-book-open.png" alt="image" align="left" style="width:24px; height:22px;
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p><strong>Definition of terms</strong> are displayed in boxes of this style.</p>

				</div>

<div class="bgPrerequisite">
					<img src="/images/glyphicons-333-certificate.png" alt="image" align="left" style="width:17px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>Possibly specific <strong>prerequisites</strong> for reading a particular section are contained in this type of box at the beginning of a section.</p>

				</div>

<p>The use of command line tools is part of this course. In a <em>Terminal</em>, you will be directed to type in <em>commands</em>. Commands are formatted as follows:</p>

<p><code>command-name argument1 argument2 ... argumentn</code></p>

<p>Throughout the exercises, when you see a word in pointed brackets, like &lt;<em>this-word</em>&gt;, it means that you have to replace everything inside the brackets, and <em>including the brackets</em>, with whatever is described within the brackets.</p>

<p>For example, if you are prompted to run a command named <em>the-command</em> which takes two arguments:</p>

<p><code>the-command -f &lt;yourfile&gt;</code></p>

<p>Then you have to replace the second argument, &lt;yourfile&gt;, with the <em>file name</em> that is being referenced in the exercise. For example</p>

<p><code>the-command -f thefile.txt</code></p>

<p>When editing a file, the contents of it will be displayed in a different font and with background colour as follows:</p>

<div class="bgEdit"><pre class="PreformatEdit">The content of the file
The next line in this file</pre></div>

<p>Output on the command line terminal is printed in boxes formatted as follows:</p>

<div class="bgTerminal"><pre class="PreformatTerminal">NectarInstance:~ Jennifer$ whoami
Jennifer</pre></div>

<h2 id="openstack-clients">OpenStack clients</h2>

<p>In the previous modules, we have used the NeCTAR Dashboard to perform simple management tasks such as launching instances, creating volumes, accessing the object store, etc. 
In this module we are going to take a look at how you can do the same tasks with other <em>“clients”</em>.</p>

<ul>
  <li>OpenStack provides <strong>command line clients</strong> which allow you to manage your instances, volumes and object store and more via command line tools only. In this tutorial, we will discuss usage of command line clients to control your resources.</li>
  <li>There are also <strong>application programming interfaces (APIs)</strong> available, mainly for Python, but also for other programming languages like e.g. C++ and Java. This is not part of this tutorial — for a list of known software development kits see <a href="https://wiki.openstack.org/wiki/OpenStackClients">OpenStack Python API Bindings</a> and <a href="https://wiki.openstack.org/wiki/SDKs">other OpenStack SDKs</a>.</li>
</ul>

<p>In a previous version of OpenStack, command line clients were split into several tools, called <strong>nova, glance, cinder, swift, keystone</strong> and more. Each of the tools was dedicated to certain tasks, e.g. <em>nova</em> for compute services, <em>swift</em> for accessing the object store, etc. Refer to the <a href="https://wiki.openstack.org/wiki/OpenStackClients">official OpenStack clients website</a> for more details.
These tools have later been brought together to <strong>one</strong> command line tool called <strong>openstack</strong>, which brings command sets for Compute, Identity, Image, Object Store and Volume APIs together in a single command set with a uniform command structure.</p>

<p>The next sections are going to discuss installation and usage of the <strong><em>openstack</em> command line client</strong> with some working examples.</p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>If you want to use the traditional OpenStack clients like <em>glance, cinder</em>, etc. you still can. The following instructions for installation and configuration also apply to the traditional clients. Only the name <em>openstack</em> in the package name <em>python-openstackclient</em> has to be replaced by the respective tool’s name in the installation command. For example, if you want to install <em>glance</em>, replace <em>python-openstackclient</em> by <em>python-glanceclient</em>.</p>

				</div>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>You may install the command line tools on <strong>any computer</strong> connected to the Internet — this may be a Linux, Mac or Windows computer. Windows users must have access to the Windows command line (it may sometimes be blocked to users without administrator privileges). The following instructions are going to assume you are familiar with using the command line.</p>

<p>Of course, you may also install the clients on your <strong>Ubuntu instance</strong> — follow the instructions for a Linux system below and use the ssh terminal to your instance to type the commands.</p>

				</div>

<h3 id="step-1-installation-of-clients">Step 1. Installation of clients</h3>

<p>This section is going to cover installation of the OpenStack command line clients. Installation for all packages is the same, only the package name has to be replaced.
Please also refer to the <a href="http://docs.openstack.org/user-guide/common/cli_install_openstack_command_line_clients.html">Official OpenStack documentation</a> for more information about installation of the OpenStack command line clients.</p>

<p>You will need to have Python installed to run the OpenStack command line clients. You may already have python installed. If you do,
check your version:</p>

<p><code>python --version</code></p>

<p>You will need to have <strong>at least version 2.7</strong>, however <strong>python 3 is not supported</strong> yet!</p>

<p>If you don’t have Python yet, the following instructions cover the installation as well. When using the Linux package managers, the right version will be installed automatically. On Mac/Windows, you have to manually install it.</p>

<ul>
  <li>
    <p><strong>Linux</strong>: Installation of the OpenStack clients is simple via the built-in package manager: Ubuntu, RDO, openSUSE and SUSE Linux Enterprise have the client packages available through the package manager. For example, on Ubuntu, you may install the package with:</p>

    <p><code>sudo apt-get install python-openstackclient</code></p>

    <p>This will install the <em>openstack</em> client with all the depending packages.</p>
    <div class="bgInfo">
                  <img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
                      margin:0px; margin-right:10px; margin-bottom:5px;" />
                  <p>If you need a newer version of an OpenStack client than is available on the Linux package manager, you can use Python’s package installer <strong><em>pip</em></strong> instead.  <em>pip</em> is a tool for easily installing and managing Python packages.   <br />
  If you don’t have <em>pip</em> yet, do so with your package manager (search for <em>python-pip</em>). For example on Ubuntu:  <br />
  <code>sudo apt-get install python-pip</code>  <br />
  After installing <em>pip</em>, you can use <em>pip</em> to install the client package:  <br />
  <code>sudo pip install python-openstackclient</code>    <br />
   To upgrade the client at a later point:  <br />
   <code>pip install --upgrade python-openstackclient</code></p>


              </div>
  </li>
  <li><strong>Mac OS X</strong>:
    <ol>
      <li>Install Python’s package manager <strong><em>pip</em></strong> (unless you already have it). <em>pip</em> is a tool for easily installing and managing Python packages. It is recommended over <em>easy_install</em>. Python 2.7.9 and later include <em>pip</em> by default, so you may have <em>pip</em> already. Either of the three options work to get <em>pip</em>:
        <ul>
          <li>If you have the homebrew package manager, <em>pip</em> installs together with the Python packages, and conveniently also installs the <em>setuptools</em> which you also need:  <br />
 <code>brew install python</code></li>
          <li>If you don’t have homebrew, the <a href="https://www.python.org/downloads/mac-osx/">official Python download</a> of package 2.7.10 or later also installs <em>pip</em> (<em>Note</em>: Python 3 is <em>not</em> supported yet).</li>
          <li><em>Alternative:</em> if you already have Python, but not <em>pip</em>, you may use the <strong><em>easy_install</em></strong> command to install <em>pip</em> — however there may be problems with running the clients when using this method. To install <em>pip</em> with <em>easy_install</em>:  <br />
 <code>sudo easy_install pip</code></li>
        </ul>
      </li>
      <li>Install <em>setuptools</em> if you don’t already have it (<em>Note</em>: If you used <em>homebrew</em> to install python in the last step, you will already have <em>setuptools</em>). Follow instructions on the <a href="https://pypi.python.org/pypi/setuptools">setuptools Website</a>.</li>
      <li>Upgrade <em>setuptools</em>  <br />
  <code>sudo pip install --upgrade setuptools</code></li>
      <li>Install your client  <br />
  <code>sudo pip install python-openstackclient</code>    <br />
   To upgrade the client at a later point:  <br />
   <code>pip install --upgrade python-openstackclient</code></li>
    </ol>
  </li>
  <li><strong>Windows</strong>:
    <ol>
      <li>Install Python 2.7 or later (<em>Note</em>: Python 3 is not supported yet!) if you don’t have it yet. You can download it on the official <a href="https://www.python.org/downloads/windows/">Python Website</a>. You may keep the default options in the installation wizard — the following instructions assume that you keep the default installation path <em>C:\Python27</em>. It is recommended that you install <strong>Python 2.7.10 or later</strong> which includes the <em>pip</em> tool which you will need.</li>
      <li>Install <em>setuptools</em>: follow the documentation provided on the <a href="https://pypi.python.org/pypi/setuptools">setuptools website</a> (the easiest is to download the <a href="https://bootstrap.pypa.io/ez_setup.py">ez_setup.py</a> file and run it).</li>
      <li>Open a Windows Command line terminal (in the “Search” field, type <em>cmd</em> — on older Windows, you may find the search field when clicking on <em>Start</em>).</li>
      <li>Make sure you have included the package <strong>pyOpenSSL (version 0.13 or higher)</strong> in your installation:
 <code>pip install pyOpenSSL</code></li>
      <li>Ensure that the <em>C:\Python27\Scripts</em> directory is defined in the PATH environment variable. To do this for the currently open terminal run the following command:   <br />
 <code>set PATH=%PATH%;C:\Python27\Scripts</code>
        <div class="bgInfo">
             <img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
                 margin:0px; margin-right:10px; margin-bottom:5px;" />
             <p>To <em>permanently</em> change an environment variable: On various Windows versions, this can be done in the <strong>Advanced System Settings</strong> (usually you can find it in <em>Control Panel</em> &gt; <em>System</em> or similar), where you should find a button <strong>Environment Variables</strong>. Scroll through the <em>System variables</em> and find <em>PATH</em> (it’s not case senstitive, so it may be <em>Path</em>). Select it and click on <em>“Edit…“</em>. At the end of the long text in the <em>Variable value</em> field, add the text <em>“;C:Python27\Scripts”</em> (without the quotation marks). Close all windows with [OK].</p>

         </div>
      </li>
      <li>If you have <em>not</em> installed Python 2.7.10 or later <em>including the pip tool</em>, you will need to install <em>pip</em> separately. You can test whether you have <em>pip</em> by typing  <br />
  <code>pip --version</code>  <br />
   in your command line. If a version is printed, you have it. Otherwise, you may use the <em>easy_install</em> command from the <em>setuptools</em> package:  <br />
 <code>easy_install pip</code></li>
      <li>Install the client:<br />
  <code>pip install python-openstackclient</code>     <br />
   To upgrade the client at a later point:  <br />
   <code>pip install --upgrade python-openstackclient</code></li>
    </ol>
  </li>
</ul>

<h3 id="step-2-get-your-openstack-credentials">Step 2. Get your OpenStack credentials</h3>

<p>Before you can use any of the clients, you will need to get your <em>OpenStack credentials</em>. In particular, you will need a script file called the <em>OpenStack RC file</em>. You will need to load the information from within this script before you can use the tools. While you are at it, you may also write down all your OpenStack login details.</p>

<p>You may already have done this in <a href="/package07/sections/index.html" title="Module 7">Module 7</a> when setting up access to your Object Store. In this case, make sure you have downloaded your <em>OpenStack RC file</em>, as you will need it now. You may then skip the following
step.</p>

<p>You can download your <strong>credentials</strong> from the <a href="https://dashboard.rc.nectar.org.au">Dashboard</a></p>

<ol>
  <li>
    <p>Your <strong>tenant ID</strong> is the name of your project as reported in the left hand panel of the dashboard (e.g. <em>pt-12345</em>)</p>
  </li>
  <li>
    <p>Your <strong>username</strong> is reported at the top of the dashboard on the right (e.g, logged in as: <em>user@uni.edu.au</em>)</p>
  </li>
  <li>
    <p>Open the <em>Dashboard API</em> tab: get there via <em>Compute &gt;  Access &amp; Security &gt;  API Access</em>.</p>
  </li>
  <li>
    <p>Look up what is specified for the <em>‘Identity’</em> Service in the <em>Dashboard API</em> tab. It will be a URL like  <br />
 <em>https://<strong>keystone.rc.nectar.org.au</strong>:<strong>5000</strong>/v2.0/</em>   <br />
 Take note of the text between <em>https://</em> and the colon (<em>keystone.rc.nectar.org.au</em> in the example). This will be the <strong>Server</strong>. Take note of the number (<em>5000</em> in the example). This will be the <strong>Port</strong>. You will need the <strong>Keystone Server and Port</strong> to authenticate your access. Also take note of the keystone version which you are using, in this case its <strong>v2.0</strong>.</p>
  </li>
  <li>
    <p>Get your <strong>credential file</strong> (this is called the <em>OpenStack RC file</em> for OpenStack, and <em>EC2 file</em> for Amazon). You can download by clicking on the buttons on the top right on the same window: <strong>Download OpenStack RC File</strong>. Download it and save it somewhere on your computer where you can easily find it later.</p>
  </li>
  <li>
    <p>You will also need your <strong>OpenStack password</strong>. This is <strong>not</strong> the same password that you use to log in to the Dashboard! If you have never used the OpenStack password before, you need to generate it first. You can do this in the <strong>Settings</strong> of the Dashboard: click next to your user name (your e-mail) on the top right and a drop down menu will open. Click on <em>Settings</em>. You need to reset your password by clicking <strong>Reset Password</strong> on the left panel of the settings. A long combination of numbers and letters will be displayed. This is your OpenStack password. Copy the text and save it somewhere safe.</p>
    <div class="bgInfo">
                 <img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
                     margin:0px; margin-right:10px; margin-bottom:5px;" />
                 <p>Your OpenStack password will be a long combination of numbers. At the time of writing, unfortunately this password cannot be changed yet, but this should be changed in a future update of OpenStack on NeCTAR.</p>


             </div>
  </li>
</ol>

<h4 id="step-3-upload-your-rc-file-to-the-instance">Step 3: Upload your RC file to the instance</h4>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>If you are configuring the client access on your <strong><em>local computer</em></strong>, you can <strong><em>skip this step</em></strong>. If you are using the ssh terminal to your instance instead, you need to do this step.</p>

				</div>

<p>Before you continue, you need to copy the <em>OpenStack RC file</em> which you downloaded from the Dashboard to your instance.</p>

<p>You may use any method to copy files to your instance, as discussed in <a href="/package07/sections/copyFiles.html">Module 7</a>, e.g. using the FTP client <em>FileZilla</em>. In the following instructions, we are going to apply the <em>command line</em> option to copy our OpenStack RC file across.</p>

<ul>
  <li>
    <p>On <strong>Linux or Mac OS X</strong>, you can use the <em>scp</em> command to do this:</p>

    <p><code>scp -i ~/.ssh/Nectar_Key &lt;path-to-your-openrc-file&gt; ubuntu@NNN.NNN.NNN.NNN:</code></p>

    <p>replacing the N’s with your IP address.
  This will have copied your openrc file in your ubuntu instance’s <em>home</em> directory.</p>
  </li>
  <li>
    <p>On <strong>Windows</strong>, you may use the <em>PuTTY</em> command line tool <em>pscp</em>.  Please refer to instructions in <a href="/package07/sections/copyFiles.html">Module 7</a> on how to install and use <em>pscp</em>.</p>
    <div class="bgInfo">
                  <img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
                      margin:0px; margin-right:10px; margin-bottom:5px;" />
                  <p>If you don’t feel comfortable using the command line, you may use an FTP client like <em>FileZilla</em> to drag and drop your file into your <em>ubuntu</em> user’s <em>home</em> directory (the <em>home</em> directory is the directory which opens up first when you connect with FileZilla). Instructions on how to use FileZilla are also included in <a href="/package07/sections/copyFiles.html">Module 7</a>.</p>

              </div>

    <p>Open the Windows Command prompt and type:</p>

    <p><code>pscp.exe -i &lt;path-to-ssh-key&gt; &lt;path-to-openrc-file&gt; ubuntu@NNN.NNN.NNN.NNN:</code></p>

    <p>replacing the N’s with your IP address. Specify the path where you have saved your nectar ssh key in &lt;path-to-ssh-key&gt; and the path to your <em>OpenStack RC</em> file in &lt;path-to-openrc-file&gt;.   <br />
  This will copy your <em>OpenStack RC</em> file to your ubuntu instance’s <em>home</em> directory.</p>
  </li>
</ul>

<h4 id="step-4-load-your-openstack-credentials-from-the-rc-file">Step 4: Load your OpenStack credentials from the RC file</h4>

<p>Before we can use the command line client, we need to load the OpenStack RC file which contains our authentication details.</p>

<ul>
  <li>
    <p><strong>Linux / Mac OS X:</strong>
  Load your credentials:</p>

    <p><code>source &lt;path-to-your-openrc-file&gt;</code></p>

    <p>using the above example for the RC files, this would be:  <br />
  <code>source ~/pt-12345-openrc.sh</code></p>

    <p>You will be prompted for your OpenStack password.</p>
    <div class="bgInfo">
                  <img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
                      margin:0px; margin-right:10px; margin-bottom:5px;" />
                  <p>You can try to copy and paste your password into the command line prompt. If this does not work in your command line, you may edit the OpenStack RC file and assign the password directly by replacing <em>$OS_PASSWORD_INPUT</em> by your password, and removing the line above (the <em>read</em> command). Then, do the <em>source</em> command above again.  <br />
  <strong>Attention</strong>: Be aware that if you do this, your OpenStack password will be openly stored in the OpenStack RC file which everyone who may gain access to your computer can read! You are creating a <strong>potential security leak</strong>, so do this only if you are absolutely sure your computer is well protected and nobody else can read the file from where it is stored. 
At the very least, it is recommended that you restrict access to this file to your user account only:  <br />
<code>chmod 0600 &lt;path-to-your-openrc-file&gt;</code></p>

              </div>
  </li>
  <li>
    <p><strong>Windows</strong>:  <br />
  You will need the <em>Windows PowerShell</em> installed (available on Windows 7 and later, or on XP with Service Pack 3).</p>

    <p>The OpenStack RC file is a script written for Unix/Mac OSX systems, so it will need to be <em>modified</em> to work with the Windows PowerShell. 
  Open your OpenStack RC file in NotePad or WordPad (<strong>not</strong> Word!!) and change it so it looks like the snippet below (with your own values from your OpenStack RC file).</p>
    <div class="bgEdit"><pre class="PreformatEdit">$env:OS_AUTH_URL="https://keystone.rc.nectar.org.au:5000/v2.0/"
$env:OS_TENANT_ID="f12d34....c"
$env:OS_TENANT_NAME="&lt;your-tentant-name&gt;"
$env:OS_USERNAME="&lt;your-email&gt;"
$env:OS_PASSWORD="&lt;Your-OpenStack-Password&gt;";
$env:OS_REGION_NAME="&lt;Your-Preset-Region-Name&gt;"</pre></div>
    <p>Make sure to save this as <em>a powershell</em> (<em>.ps1</em>) file in <em>plain text</em> (pre-select <em>.txt</em> if necessary and then change the suffix to <em>.ps1</em>). For simplicity, save the file as <em>openrc.ps1</em> in your user folder, which usually is <em>C:\Users\&lt;Your-User-Name&gt;</em>.  <br />
  Then, open the <strong>Windows Powershell</strong> by typing into the Windows Command line:  <br />
  <code>powershell.exe</code>  <br />
  And load your credentials:  <br />
  <code>C:\Users\&lt;Your-User-Name&gt;\openrc.ps1</code>  <br />
  <em>Note:</em> Alternatively, you may use the Windows PowerShell Terminal directly. Search for “powershell” in the App Search.</p>
    <div class="bgImportant">
                  <img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
                    margin:0px; margin-right:10px; margin-bottom:5px;" />
                  <p>Make sure only you can read the <em>openrc.ps1</em> file, because the OpenStack password is readable on it.
Right-click on the file, select “Properties”, go to the “Security” Tab, click “Edit…” and remove all names but your own user name.</p>

              </div>
  </li>
</ul>

<p>You will have to load your credentials <strong>every time</strong> after you reboot your computer or open up a new terminal, otherwise you cannot use the clients. 
Use the same command as above to load them afresh.</p>

<h4 id="step-5-use-your-openstack-client">Step 5: Use your OpenStack client</h4>

<p>You are now ready to use your OpenStack client in the command line session in which you loaded your OpenStack RC file in the last step.</p>

<p>Keep this terminal open to follow the instructions in the next sections.</p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>Whenever you start over (e.g. after you close the terminal), you only need to load (<em>“source”</em>) your OpenStack RC file in order to get ready to use the OpenStack client, as described in the last step: <br />
<code>source &lt;path-to-your-openrc-file&gt;</code></p>

				</div>

<p>You can display help for the <em>openstack</em> command with:</p>

<p><code>openstack help</code></p>

<p>And if you would like to see the more detailed help for a particular sub-tool, e.g. the <em>server</em> tool:</p>

<p><code>openstack help server</code></p>

<p>For supporting and further documentation throughout the next sections, please refer to the <a href="http://docs.openstack.org/developer/python-openstackclient/">official openstack client documentation</a>.</p>

<h2 id="accessing-the-object-store">Accessing the object store</h2>

<div class="bgPrerequisite">
					<img src="/images/glyphicons-333-certificate.png" alt="image" align="left" style="width:17px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p><em>Prerequisite</em>: You need to have installed the <em>python-openstackclient</em> using the instructions given earlier. You should also be familiar with the terminology and concepts involved with the object store, as described in <a href="/package06/sections/index.html" title="Module 6">Module 6</a> and <a href="/package07/sections/index.html" title="Module 7">Module 7</a>. You also must have <em>sourced</em> your OpenStack RC file on the command line you are using, as described <a href="openstackClients.html">earlier in this module</a>.</p>

				</div>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>Before the <strong>openstack</strong> client was introduced, access to the object store was managed with the <strong>swift</strong> command, so you may still find references to it on the Internet. While you still can use <em>swift</em>, in this tutorial we stick to the more uniform and intuitive <em>openstack</em> client, which works similarly to the <em>swift</em> command.
For more details, refer to the <a href="http://docs.openstack.org/developer/swift/">official OpenStack swift</a> documentation.</p>

				</div>

<p>You can display help for the <em>openstack</em> command with:</p>

<p><code>openstack help</code></p>

<p>This will print a list of options for this command. Each option listed can be seen as a ‘sub-command’. You may print more information about usage of the particular sub-command, e.g. for <em>object</em> and <em>container</em> which we are going to use in this section:</p>

<p><code>openstack help object</code>  <br />
<code>openstack help container</code></p>

<p>For supporting and further documentation, please refer to the <a href="http://docs.openstack.org/developer/python-openstackclient/">official openstack client documentation</a>.</p>

<p>In this section, we are going to learn how to</p>

<ul>
  <li>
    <p>List your containers and files</p>
  </li>
  <li>
    <p>Create and delete Containers</p>
  </li>
  <li>
    <p>Upload and download files</p>
  </li>
</ul>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>The following instructions will assume that all the <em>Names</em> you choose for containers and files have <strong>no whitespaces</strong> in them. If the names <em>do</em> include white spaces, you have to put the name in quotation marks when using them in the commands, e.g. “Name of container”.</p>

				</div>

<h3 id="list-your-files">List your files</h3>

<p>Type</p>

<p><code>openstack container list</code></p>

<p>and you should see the containers which you have already created.</p>

<div class="bgTerminal"><pre class="PreformatTerminal">+-------------------+
| Name              |
+-------------------+
| MyObjectContainer |
+-------------------+</pre></div>

<p>To display the contents of a container:</p>

<p><code>openstack object list &lt;your-container-name&gt;</code></p>

<p>will list the file(s) you have just uploaded to this container. If you have followed the tutorial in <a href="/package07/sections/index.html" title="Module 7">Module 7</a>, you should see the file which you uploaded via the Dashboard.</p>

<div class="bgTerminal"><pre class="PreformatTerminal">+------------------+
| Name             |
+------------------+
| SampleObject.txt |
+------------------+</pre></div>

<h3 id="manage-containers-and-transfer-files">Manage containers and transfer files</h3>

<p>To upload an object to the store, the file must be on the computer which you use to type the commands in the terminal.</p>

<p>As an example, create a text file named <em>MyNewTextFile.txt</em>, write some text in it, and save it in your home directory (or on Windows, place it in <em>D:\Users\&lt;YourUserName&gt;</em>). First, create the new container:</p>

<p><code>openstack container create MyTestContainer</code></p>

<p>You can now see your new container is listed with</p>

<p><code>openstack container list</code></p>

<div class="bgTerminal"><pre class="PreformatTerminal">+-------------------+
| Name              |
+-------------------+
| MyObjectContainer |
| MyTestContainer   |
+-------------------+</pre></div>

<p>You may <strong>upload a file</strong> with the command:</p>

<p><code>openstack object create &lt;container name&gt; &lt;path to local file&gt;</code></p>

<p>In the example, upload the file you have created to the new container <em>MyTestContainer</em>:</p>

<p><code>openstack object create MyTestContainer ~/MyNewTextFile.txt</code></p>

<p><em>Note:</em> On <strong>Windows</strong>, you have to use the Windows command line syntax to specify the path to the file. This tutorial assumes you are familiar with how to modify the commands to use the conventions of the Windows command line.</p>

<p>This will have created a new container called <em>MyTestContainer</em> (unless you had a container with this name already). List the files which are there now:</p>

<p><code>openstack object list MyTestContainer</code></p>

<div class="bgTerminal"><pre class="PreformatTerminal">+-----------------------------------+
| Name                              |
+-----------------------------------+
| /home/yourname/MyNewTextFile.txt  |
+-----------------------------------+</pre></div>

<p>Note that the path to your filename has been included in the name, which is not very convenient. Unfortunately, the only way around this is to upload a file which is in the <em>current working directory</em>. So let’s delete the file, and then upload it without the path:</p>

<p><code>openstack object delete MyTestContainer /home/yourname/MyNewTextFile.txt</code>  <br />
<code>cd ~</code>  <br />
<code>openstack object create MyTestContainer MyNewTextFile.txt</code></p>

<p>And list the files again to see that the file name stands alone now:</p>

<p><code>openstack object list MyTestContainer</code></p>

<div class="bgTerminal"><pre class="PreformatTerminal">+-----------------------------------+
| Name                              |
+-----------------------------------+
| MyNewTextFile.txt                 |
+-----------------------------------+</pre></div>

<p>You may display information about your file with:</p>

<p><code>openstack object show MyTestContainer MyNewTextFile.txt</code></p>

<p>This will display properties and metadata of your file, e.g. <em>content-length</em> displays the length in bytes.</p>
<div class="bgTerminal"><pre class="PreformatTerminal">+----------------+--------------------------+
| Field          | Value                    |
+----------------+--------------------------+
| accept-ranges  | bytes                    |
| account        | None                     |
| container      | MyTestContainer          |
| content-length | 112                      |
| content-type   | text/plain               |
| etag           | d41d8cd98f00b204e98...   |
| last-modified  | Thu, 02 Jul 201...       |
| object         | MyNewTextFile.txt        |
| x-timestamp    | 1435842936.81309         |
| x-trans-id     | tx42ec77c1403b47c...     |
+----------------+--------------------------+</pre></div>

<p>Now, let’s <strong>download</strong> that same file again and save it as another name, to see that it still has the right content:</p>

<p><code>openstack object save --file &lt;destination path&gt; &lt;container name&gt; &lt;file name&gt;</code></p>

<p>The argument <code>--file</code> specifies the destination path on your computer where you want to save the file. If you want to keep the name of the file, this path can be the destination folder only. If you want to rename the file at the same time, specify a file name also. 
In our example, if we want to save the file as <em>MyDownloadedFile.txt</em> into our home directory, the command becomes:</p>

<p><code>openstack object save --file ~/MyDownloadedFile.txt MyTestContainer MyNewTextFile.txt</code></p>

<p>You may now open the file <em>MyDownloadedFile.txt</em> in your home directory and see that it has the same text it contained originally.</p>

<p>Finally, let’s delete the container which we used for this example:</p>

<p><code>openstack container delete MyTestContainer</code></p>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>This will <strong>delete all the files</strong> which you have uploaded to this container!</p>

				</div>

<h3 id="access-to-the-object-store-from-apis">Access to the Object Store from APIs</h3>

<p>It is also possible to access your files in the Object Store from within program code. For example, there are APIs for C++ and Java.</p>

<p>Access via APIs is not part of this tutorial. Please refer to the <a href="http://support.rc.nectar.org.au/docs/object-storage">NeCTAR support website</a> and the <a href="https://wiki.openstack.org/wiki/SDKs">official OpenStack SDKs website</a> for more information.</p>

<h2 id="controlling-an-instance">Controlling an instance</h2>

<div class="bgPrerequisite">
					<img src="/images/glyphicons-333-certificate.png" alt="image" align="left" style="width:17px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p><em>Prerequisite</em>: You need to have installed the <em>python-openstackclient</em> using the instructions given earlier. You should also be familiar with the terminology and concepts involved in launching an instance, as described in <a href="/package07/sections/index.html" title="Module 7">Module 7</a>. You also must have <em>sourced</em> your OpenStack RC file on the command line you are using, as described <a href="openstackClients.html">earlier in this module</a>.</p>

				</div>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>Before the <strong>openstack</strong> client was introduced, managing compute services was done with the <strong>nova</strong> command, so you may still find references to it on the Internet. While you still can use <em>nova</em>, in this tutorial we stick to the more uniform and intuitive <em>openstack</em> client, which works similarly to the <em>nova</em> command.
For more details, refer to the <a href="http://docs.openstack.org/developer/nova/">official OpenStack nova</a> documentation.</p>

				</div>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>The following instructions will assume that all the <em>Names</em> you choose for instances, volumes, etc. have <strong>no whitespaces</strong> in them. If the names <em>do</em> include white spaces, you have to put the name in quotation marks when using them in the commands, e.g. “Name of resource”.</p>

				</div>

<p>You may display information about all the instances you are running:</p>

<p><code>openstack server list</code></p>

<p>This will output a line like this one for each running instance:</p>

<div class="bgTerminal"><pre class="PreformatTerminal">+--------------+----------------------+--------+----------------------------+
| ID           | Name                 | Status | Networks                   |
+--------------+----------------------+--------+----------------------------+
| be290858-... | MyFirstInstance      | ACTIVE | intersect-01=43.240.96.180 |
+--------------+----------------------+--------+----------------------------+</pre></div>

<p>You can display more information about your instances with:</p>

<p><code>openstack server show &lt;instance ID&gt;</code></p>

<p>Where the instance ID is the long combination of numbers, dashes and letters shown in the <em>openstack server list</em> command. Alternatively, you may use the <em>name</em> of the instance, e.g.:</p>

<p><code>openstack server show MyFirstInstance</code></p>

<p>in the example above. This will display a lot of information about this particular instance.</p>

<p>You can display help for the <em>openstack</em> command with:</p>

<p><code>openstack help</code></p>

<p>This will print a list of options for this command. Each option listed can be seen as a ‘sub-command’. You may print more information about usage of the particular sub-command, e.g. for <em>server</em> which we are going to use in this section:</p>

<p><code>openstack help server</code></p>

<p>In the following, we are going to discuss <em>openstack server</em> commands for</p>

<ul>
  <li>
    <p>Launching an instance</p>
  </li>
  <li>
    <p>Taking a snapshot of an instance</p>
  </li>
  <li>
    <p>Launching a new instance from a snapshot</p>
  </li>
</ul>

<p>For supporting and further documentation, please refer to the <a href="http://docs.openstack.org/developer/python-openstackclient/">official openstack client documentation</a>.</p>

<h3 id="launching-an-instance">Launching an instance</h3>

<p>You can also launch an instance with <em>openstack server</em> instead of using the <a href="https://dashboard.rc.nectar.org.au">Dashboard</a> as we have done in <a href="/package07/sections/index.html" title="Module 7">Module 7</a>.</p>

<p>First, you may want to take a look at the flavors which are available and pick the one you’d like:</p>

<p><code>openstack flavor list</code></p>

<p>In this tutorial, let’s pick the flavor <em>m1.small</em>.
Take note of the ID (first column of the printed information) and name. When compiling this tutorial, the ID for the flavor <em>m1.small</em> was <em>0</em>, but in your case it may also be a long string of characters.</p>

<p>Now, you should pick an image to launch your instance from. Just as in <a href="/package07/sections/index.html" title="Module 7">Module 7</a>, we will use the Ubuntu 14.10 image.</p>

<p><code>openstack image list</code></p>

<p>Because there are a lot of images, the list will be very long. To make it easier to find the right Ubuntu 14.10 image in the NeCTAR images, type:</p>

<p><code>openstack image list | grep 14.10</code></p>

<p>Find the image <em>NeCTAR Ubuntu 14.10 (Utopic) amd64” and take note of the ID, which may be a number or a long string of characters. When compiling this tutorial, the ID was *fc48b5bb-e67d-4e39-b9ba-b6725c8b0c88</em>.</p>

<p>You now have to configure the ssh keys you want to use. Your <em>Nectar_Key</em> should show up in the following command (with another name if you chose another launching the instance in Module 7):</p>

<p><code>openstack keypair list</code></p>

<p>We will use the same key in this tutorial, so take note that the <strong>Keypair Name</strong> (first column) is the one you chose for the key, i.e. <em>Nectar_Key</em>.</p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>You may also add a new key. The command</p>

<p><code>openstack keypair create &lt;name&gt;</code></p>

<p>will generate a key with the &lt;name&gt; of your choice, and print the private key to the terminal. You have to copy and save this output <strong>now</strong> to a file and store it somewhere as your private key.</p>

<p>If you want to select an existing key that you generated earlier, you have to specify the path to your <em>public</em> key, which you must be able to access from your terminal:</p>

<p><code>openstack keypair create --public-key &lt;path-to-your-pub-key&gt; &lt;name&gt;</code></p>

<p>You can display the help for <em>keypair create</em> with</p>

<p><code>openstack help keypair create</code></p>

				</div>

<p>You may display information about a specific key with:</p>

<p><code>openstack keypair show &lt;keypair-name&gt;</code></p>

<p>using the keypair name for which you want to display the information.</p>

<p>Let’s now display information about the security groups:</p>

<p><code>openstack security group list</code></p>

<p>This should display something like this:</p>

<div class="bgTerminal"><pre class="PreformatTerminal">+-------+---------+-------------+
|    ID | Name    | Description |
+-------+---------+-------------+
| 86498 | default | default     |
| 90284 | http    | Allow http  |
| 86501 | icmp    | Allow icmp  |
| 86504 | ssh     | Allow ssh   |
+-------+---------+-------------+</pre></div>

<p>Take note of the security group <em>names</em> (2nd column) for <em>icmp</em> and <em>ssh</em>.</p>

<p>The last thing we may need to specify before we launch an instance is the <em>Availability Zone</em>. List all the available zones with:</p>

<p><code>openstack availability zone list</code></p>

<p>Take note of your <em>Zone Name</em> (first column), if you want to use a particular zone. Otherwise, you won’t need to specify the availability zone and you will be assigned the most suitable one automatically.</p>

<p>Now, you may launch your instance with the command <em>openstack server create</em>. Display help about this command:</p>

<p><code>openstack help server create</code></p>

<p>which will describe the options available. Launch your instance:</p>

<p><code>openstack server create --flavor &lt;flavor-id&gt; --key-name &lt;keypair-name&gt; --image &lt;image-id&gt; --security-group &lt;group name&gt; --availability-zone &lt;zone name&gt; &lt;name-of-instance&gt;</code></p>

<p>As a name for the instance, choose <em>ClientLaunchedInstance</em>.
For the flavor, you may specify either the <em>name</em> or the <em>id</em> of that flavor. 
If you assign several security groups, you must repeat the <em>–security-group</em> argument before each group name. 
If you don’t want to use a specific availability zone, you may skip the <em>–availability-zone</em> argument.
At the time this tutorial was created, the command (without availability zone) was:</p>

<p><code>openstack server create --flavor m1.small --key-name Nectar_Key 
    --security-group icmp --security-group ssh --image fc48b5bb-e67d-4e39-b9ba-b6725c8b0c88 ClientLaunchedInstance</code></p>

<p>It will display information about the instance being created, similar to these <em>extracts</em> of output:</p>
<div class="bgTerminal"><pre class="PreformatTerminal">+-------------------------------+--------------------------------------------+
| Field                         | Value                                      |
+-------------------------------+--------------------------------------------+
| OS-DCF:diskConfig             | MANUAL                                     |
| OS-EXT-AZ:availability_zone   | intersect                                  |
| OS-EXT-STS:power_state        | 0                                          |
| OS-EXT-STS:task_state         | scheduling                                 |
| OS-EXT-STS:vm_state           | building                                   |
| flavor                        | m1.small (0)                               |
| hostId                        |                                            |
| id                            | b720630a-e0dd-4ecd-9ceb-5e3519e69edc       |
| image                         | NeCTAR Ubuntu 14.10 (Utopic) amd64 (fc4..) |
| key_name                      | Nectar_Key                                 |
| name                          | ClientLaunchedInstance                       |
| security_groups               | [{u'name': u'icmp'}, {u'name': u'ssh'}]    |
| status                        | BUILD                                      |
+-------------------------------+--------------------------------------------+</pre></div>

<p>The state (<em>vm_state</em>) will probably still be <em>“building”</em>.
Once the instance has been created, it will show up in the output of <em>openstack server list</em> and <em>openstack server show</em>.</p>

<p>You can check if the status of the instance is <strong>Active</strong> with the command:</p>

<p><code>openstack server list</code></p>

<p>Once it is active, you may look up the IP address for <em>ClientLaunchedInstance</em> with</p>

<p><code>openstack server show ClientLaunchedInstance</code></p>

<p><strong>Congratulations!! You have now launched your instance.</strong></p>

<p>You may now try to login to your instance with the SSH command, as described in <a href="/package07/sections/connectViaSSH.html">Module 7</a>. 
Use the IP address which is displayed for your new instance to login via ssh. For example, on a Linux or Mac:</p>

<p><code>ssh -i .ssh/Nectar_Key ubuntu@NNN.NNN.NNN.NNN</code></p>

<p>replacing the N’s with the IP address.</p>

<p>For more information, see also the <a href="http://docs.openstack.org/developer/python-openstackclient/">official OpenStack Client documentation</a>.</p>

<p>You can now go to the Dashboard and observe that your new instance will be listed there as well.</p>

<p>You may reboot the instance with</p>

<p><code>openstack server reboot &lt;instance-name&gt;</code></p>

<p>and <em>terminate</em> (delete) it with</p>

<p><code>openstack server delete &lt;instance-name&gt;</code></p>

<p>If you want to add a new security group, you can easily do this after launching as well:</p>

<p><code>openstack server add security group &lt;group name&gt;</code></p>

<p>To get more information about the <em>openstack server</em> command:</p>

<p><code>openstack help server</code></p>

<h3 id="taking-a-snapshot-of-an-instance">Taking a snapshot of an instance</h3>

<p>Taking a snapshot of the instance is easy. Using your <em>Instance Name</em>:</p>

<p><code>openstack server image create --name &lt;Image-Name&gt; &lt;Instance-Name&gt;</code></p>

<p>The snapshot will be <strong>saved as an Image</strong> with the name you choose. In the example given in this tutorial, the command is:</p>

<p><code>openstack server image create --name ClientLaunchedSnapshot ClientLaunchedInstance</code></p>

<p>This process may take a while. In the beginning, the ‘status’ of your snapshot will be <em>queued</em>.</p>

<p>You can check on the status of your snapshot with:</p>

<p><code>openstack image show &lt;Image-Name&gt;</code></p>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>It is possible to take a <strong>“Live snapshot”</strong> (take a snapshot of the machine that is currently running). In most cases, there should be no problem. However, if the instance is running while the snapshot is being taken, the resulting snapshot <em>may</em> be inconsistent. This is due to programs writing on the file system while a snapshot is taken. There are a few options to prevent this inconsistency from happening:</p>

<ul>
  <li>running “sync” before starting the snapshot, or</li>
  <li>using a “file system freeze” utility which block programs writing on the filesystem,</li>
  <li>shutting down or pausing the instance before snapshotting.</li>
</ul>

<p>The easiest option is probably to pause or shut down the instance and then take the snapshot. For more information, refer to the <a href="http://docs.openstack.org/trunk/openstack-ops/content/snapshots.html">OpenStack documentation</a>.</p>

				</div>

<h3 id="launch-an-instance-from-a-snapshot">Launch an instance from a snapshot</h3>

<p>Because your snapshot was saved as an <em>Image</em>, you can easily launch the instance from this image. Instead of the <em>NeCTAR Ubuntu Image</em> which we used earlier, you can now specify your own image to launch a new instance. The new instance will have all the software you installed before taking the snapshot, and all the data you saved the on-instance storage (on the primary disk, <em>not</em> the secondary!).</p>

<p>You can print a list of all the images (instance and volume snapshots) you have created, if you would like a reminder for the snapshot name:</p>

<p><code>openstack image list --private</code></p>

<p>And more details about the images can be displayed with</p>

<p><code>openstack image show &lt;Image Name&gt;</code></p>

<p>You may launch an instance from your own image with the same command we used earlier to launch an instance:</p>

<p><code>openstack server create --flavor &lt;flavor-id&gt; --key-name &lt;keypair-name&gt; --image &lt;snapshot-name&gt; --security-group &lt;group name&gt; --availability-zone &lt;zone name&gt; &lt;name-of-instance&gt;</code></p>

<p>In our particular example, the command becomes:</p>

<p><code>openstack server create --flavor m1.small --key-name Nectar_Key 
    --security-group icmp --security-group ssh --image ClientLaunchedSnapshot CopyOfClientLaunchedInstance</code></p>

<p>List the details of your new instance with</p>

<p><code>openstack server show CopyOfClientLaunchedInstance</code></p>

<p>You have now two copies of your original instance running. You may log in with ssh to <em>CopyOfClientLaunchedInstance</em> as well.</p>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>Note that you may also choose a <strong>different flavor</strong> when you launch a new instance from the snapshot! This allows you to expand your resources (though you can do this more easily by following the process outlined in <em>openstack help server resize</em>). You should not choose a flavor with less storage available on the primary on-instance disk, otherwise the launching of your instance may fail due to lack of disk space.</p>

				</div>

<h2 id="managing-volumes">Managing volumes</h2>

<div class="bgPrerequisite">
					<img src="/images/glyphicons-333-certificate.png" alt="image" align="left" style="width:17px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p><em>Prerequisite</em>: You need to have installed the <em>python-openstackclient</em> using the instructions given earlier. You should also be familiar with the terminology and concepts involved for managing volumes, as described in <a href="/package06/sections/index.html" title="Module 6">Module 6</a> and <a href="/package07/sections/index.html" title="Module 7">Module 7</a>. You also must have <em>sourced</em> your OpenStack RC file on the command line you are using, as described <a href="openstackClients.html">earlier in this module</a>.</p>

				</div>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>Before the <strong>openstack</strong> client was introduced, managing volumes was done with the <strong>cinder</strong> and <strong>nova</strong> commands, so you may still find references to it on the Internet. While you still can use <em>cinder</em> and <em>nova</em>, in this tutorial we stick to the more uniform and intuitive <em>openstack</em> client, which works similarly to the <em>cinder</em> and <em>nova</em> commands. 
For more details, refer to the <a href="http://docs.openstack.org/developer/cinder/">official OpenStack cinder</a> and <a href="http://docs.openstack.org/developer/nova/">nova</a> documentation.</p>

				</div>

<p>You can display help for the <em>openstack</em> command with:</p>

<p><code>openstack help</code></p>

<p>This will print a list of options for this command. Each option listed can be seen as a ‘sub-command’. You may print more information about usage of the particular sub-command, e.g. for <em>volume</em> which we are going to use in this section:</p>

<p><code>openstack help volume</code></p>

<p>For supporting and further documentation, please refer to the <a href="http://docs.openstack.org/developer/python-openstackclient/">official openstack client documentation</a>.</p>

<p>In this section we are going to deal with managing <em>Volumes</em>:</p>

<ul>
  <li>
    <p>Creating and deleting volumes</p>
  </li>
  <li>
    <p>Attaching and detaching volumes from instances</p>
  </li>
  <li>
    <p>Taking snapshots and backups of volumes, and</p>
  </li>
  <li>
    <p>Restoring volumes from snapshots or backups</p>
  </li>
</ul>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>You cannot use Volumes if you are using the NeCTAR Trial Account. You need to submit an allocation request to get access to volume storage. You may read more about allocations in <a href="/package05/sections/allocations.html">Module 5</a>.</p>

				</div>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>The following instructions will assume that all the <em>Names</em> you choose for instances, volumes, etc. have <strong>no whitespaces</strong> in them. If the names <em>do</em> include white spaces, you have to put the name in quotation marks when using them in the commands, e.g. “Name of resource”.</p>

				</div>

<h4 id="create-a-new-volume">Create a new volume</h4>

<p>You may list the volumes you already have with:</p>

<p><code>openstack volume list</code></p>

<p>This will print information about your existing volumes (or print nothing if you don’t have any volumes yet):</p>
<div class="bgTerminal"><pre class="PreformatTerminal">+------------------+----------+--------------+------+-------------+----------+-----------------+
|  ID              |  Status  | Display Name | Size | Volume Type | Bootable |  Attached to    |
+------------------+----------+--------------+------+-------------+----------+-----------------+
| 494e6104-a282-...|  in-use  | MyVolume     |  1   |  intersect  |  false   | a87a...         |
+------------------+----------+--------------+------+-------------+----------+-----------------+</pre></div>

<p>Creating a new volume is easy using the <em>openstack</em> client. You can display help for volume creation with:</p>

<p><code>openstack help volume create</code></p>

<p>to see the syntax of the command and some optional arguments.</p>

<p>Now, create a new Volume called <em>MyNewStorage</em> sized <em>1GB</em> with the following command (specifying your own availability zone):</p>

<p><code>openstack volume create --description "Description of the volume" --availability-zone &lt;zone name&gt; --size 1 MyNewStorage</code></p>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>You will need to specify the <em>same</em> availability zone in which the instance you want to attach it to is running, or you will not be able
to attach the volume to the instance.</p>

<p>To list all availability zones:  <br />
<code>openstack availability zone list</code></p>

				</div>

<p>A summary will be printed which shows the details of the volume you are creating (extracts shown in output):</p>

<div class="bgTerminal"><pre class="PreformatTerminal">+---------------------+--------------------------------------+
| Field               | Value                                |
+---------------------+--------------------------------------+
| attachments         | []                                   |
| availability_zone   | intersect                            |
| bootable            | false                                |
| display_description | Description of the Volumme           |
| display_name        | MyNewStorage                         |
| encrypted           | False                                |
| id                  | 42385945-e2...                       |
| properties          |                                      |
| size                | 1                                    |
| snapshot_id         | None                                 |
| source_volid        | None                                 |
| status              | creating                             |
| type                | intersect                            |
+---------------------+--------------------------------------+</pre></div>

<p>The <em>status</em> of the volume should switch to <em>‘Available’</em> soon. Re-check the status with</p>

<p><code>openstack volume show MyNewStorage</code></p>

<p>After the volume has been created, when you type</p>

<p><code>openstack volume list</code></p>

<p>you should see your new volume in the list.</p>

<p>If you want to <em>delete</em> a volume again, use this command:</p>

<p><code>openstack volume delete &lt;volume name or ID&gt;</code></p>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>When you delete a volume, you will <strong>lose all data and access</strong> to this volume. Make sure you <strong>back up</strong> all data, and <strong>securely erase</strong> the data on the volume (as described in <a href="/package09/sections/index.html" title="Module 9">Module 9</a>) <em>before</em> you delete it!</p>

				</div>

<h4 id="attachingdetaching-a-volume-to-an-instance">Attaching/Detaching a volume to an instance</h4>

<p>To attach and detach a volume to an instance, you will use the command tool <em>openstack server</em>. You can display help about this command by running the following:</p>

<p><code>openstack server help | grep volume</code></p>

<p>First, find the instance name that you want to attach the volume to by listing all your instances:</p>

<p><code>openstack server list</code></p>

<div class="bgTerminal"><pre class="PreformatTerminal">+-------------------+----------------------------+--------+----------------------------+
| ID                | Name                       | Status | Networks                   |
+-------------------+----------------------------+--------+----------------------------+
| af87a5c8-e751-... | CopyOfClientLaunchedInstance | ACTIVE | intersect-02=137.92.56.42  |
| b720630a-e0dd-... | ClientLaunchedInstance       | ACTIVE | intersect-02=137.92.56.36  |
+-------------------+----------------------------+--------+----------------------------+</pre></div>

<p>To attach a volume, you may use this command:</p>

<p><code>openstack server add volume  &lt;Server-Name&gt; &lt;Volume-Name&gt;</code></p>

<p><strong>Server-Name</strong>: the name (or ID) of instance which you want to attach the volume to. Let’s attach it to the instance we launched in the last section, which is named <em>ClientLaunchedInstance</em>.</p>

<p><strong>Volume-Name</strong>: The name (or ID) of the volume you want to attach. We will attach the volume <em>MyNewStorage</em> which we just created.</p>

<p>with the examples used in this tutorial the command becomes:</p>

<p><code>openstack server add volume ClientLaunchedInstance MyNewStorage</code></p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>The <code>openstack server add volume</code> command also offers an argument <code>--device</code>. This <em>optional</em> argument is intended to set the device mapping, e.g. <em>/dev/mydevice</em>. OpenStack <strong>currently ignores</strong> this option when attaching volumes, so you should skip this option at this stage (it may be that your command does not work if you specify this option).</p>

				</div>

<p>The command will take a while to execute. 
When it is finished, when you run</p>

<p><code>openstack volume list</code></p>

<p>the output should show that your volume is attached:</p>
<div class="bgTerminal"><pre class="PreformatTerminal">+--------------+--------------+--------+------+-----------------------------------------------+
| ID           | Display Name | Status | Size | Attached to                                   |
+--------------+--------------+--------+------+-----------------------------------------------+
| 42385945-... | MyNewStorage | in-use |    1 | Attached to ClientLaunchedInstance on /dev/vdc  |
+--------------+--------------+--------+------+-----------------------------------------------+</pre></div>

<p>OpenStack adds the volume as the lowest available device name: For a standard flavor instance (with a primary &amp; secondary drive) the first volume will be attached as <em>/dev/vdc</em>. You can see where your device has been mapped to in the last column of the output.</p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>You may attach <em>several</em> volumes to one instance. However you may only attach one volume to <em>one</em> instance at a time.</p>

				</div>

<p>To <strong>detach</strong> a volume, use a similar command:</p>

<p><code>openstack server remove volume &lt;Server-Name&gt; &lt;Volume-Name&gt;</code></p>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>Before you detach a volume, you have to <strong>unmount</strong> it! <a href="/package07/sections/index.html" title="Module 7">Module 7</a> includes information about mounting and unmounting drives.</p>

				</div>

<p>Now, detach the volume again that we have just attached:  <br />
<code>openstack server remove volume ClientLaunchedInstance MyNewStorage</code></p>

<p>After detaching, if you run</p>

<p><code>openstack volume list</code></p>

<p>you will see that the status of the volume is no longer <em>“in-use”</em>, instead it is <em>“available”</em>.</p>

<h3 id="backups-and-snapshots">Backups and Snapshots</h3>

<p>You may create a <em>Backup</em> of a volume, or take a <em>Snapshot</em> of it.
The difference between Backup and Snapshot has been explained in <a href="/package09//sections/backup.html">Module 9</a>: The key difference is that a Snapshot creates an <em>Image</em> of the size your Volume has, whereas a Backup creates a <em>backup file</em> which has the size of your <em>used</em> storage, and saves it in the <em>Object Store</em>. Another important difference is that Backups can be used to restore the state onto an <em>existing</em> volume, whereas with a Snapshot, it is only possible to create an entirely <em>new</em> volume from it.</p>

<p><strong>1. Backup and restore a volume</strong></p>

<p>To manage your volume Backups, you will use the command set <em>openstack backup</em>:</p>

<p><code>openstack help backup</code> <br />
<code>openstack help backup create</code></p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>Backups will back up the entire state of your Volume. If you volume is encrypted, the encryption will be backed up with it. So after you restore this backup onto a new volume, you will also need to install the volume encryption and activate it with your password!</p>

				</div>

<p>Before you can create a Backup, you must <em>detach</em> the volume from any instances. You need to first <em>unmount</em> the device (if you have mounted it from an instance), and then detach it, as described earlier. A volume is <em>detached</em> when it is in the status <em>“available”</em>. Check this with</p>

<p><code>openstack volume list</code></p>

<p>You will see <em>“Backup1”</em> listed along with its current status.</p>

<p>To create a backup of the volume named <em>MyNewStorage</em>, and save it into the object store container <em>“Backups”</em> naming it <em>“Backup1”</em> use the following command:</p>

<p><code>openstack backup create --container Backups --name Backup1 --description "Backup MyNewStorage" MyNewStorage</code></p>

<p>While the argument <code>--description</code> is optional, it is recommended you fill in some meaningful information about this backup here, as it will make it
easier to identify it when you want to restore it.</p>

<p>If the container <em>“Backups”</em> did not already exist, it will have been created. 
After creating the backup, your volume will be have the status <em>“backing-up”</em>, which can take a while. Type</p>

<p><code>openstack backup list</code></p>

<p>to see the status of your Volume backup.</p>

<div class="bgTerminal"><pre class="PreformatTerminal">+--------------------+---------+---------------------+-----------+------+
| ID                 | Name    | Description         | Status    | Size |
+--------------------+---------+---------------------+-----------+------+
| eb4d23e7-861e-4... | Backup1 | Backup MyNewStorage | available |    1 |
+--------------------+---------+---------------------+-----------+------+</pre></div>

<p>After the backup has been done, you can see it listed in your Object Store:</p>

<p><code>openstack container list</code>  <br />
<code>openstack object list Backups</code></p>

<p>The Backups container has been created (unless you already had it). You will see a rather long list of files in the <em>Backups</em> container — which means your Backup has been saved in several object files. This should not concern you, however, as you can restore the data with only one command.</p>

<p>To restore your Volume to the state we just saved in <em>Backup1</em>, first obtain the <em>ID</em> of this backup, which is displayed in the first column of the output:</p>

<p><code>openstack backup list</code></p>

<p>You will need the <em>ID</em> (in this case, the <em>Name</em> does not work) to display some more information about this Backup:</p>

<p><code>openstack backup show &lt;Backup-ID&gt;</code></p>

<div class="bgTerminal"><pre class="PreformatTerminal">+-------------------+-----------------------+
| Field             | Value                 |
+-------------------+-----------------------+
| availability_zone | intersect             |
| container         | Backups               |
| created_at        | 2015-07-...           |
| description       | Backup MyNewStorage   |
| fail_reason       | None                  |
| id                | eb4d23e7-8 ...        |
| name              | Backup1               |
| object_count      | 22                    |
| size              | 1                     |
| status            | available             |
| volume_id         | 42385945-e2d2...      |
+-------------------+-----------------------+</pre></div>

<p>Note that the Volume ID (field <em>volume_id</em>) is displayed in the information to remind us which volume the backup is from. The ID is not very intuitive, so it is a good idea to add a meaningful description to the backup when you create it.</p>

<p>To restore a backup, first display the help for the <em>backup restore</em> tool:</p>

<p><code>openstack help backup restore</code></p>

<p>To restore the volume <em>MyNewStorage</em> to the state we saved in <em>Backup1</em>, use the command:</p>

<p><code>openstack backup restore &lt;Backup-ID&gt; MyNewStorage</code></p>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>You may also restore the backup to a volume other than the Volume you took the Backup of — the Backup is <strong>not bound to the original Volume</strong> you took the Backup of!</p>

<p>When you restore to <strong>any Volume</strong>, you must keep the following in mind:</p>

<ul>
  <li>
    <p>all data on the Volume you choose as the restore target <strong>will be lost</strong>! The state of the Volume after the restore is going to be <strong>exactly the state</strong> which your Volume was in when you made the Backup.</p>
  </li>
  <li>
    <p>the Volume needs to be large enough to fit your backup data.</p>
  </li>
  <li>
    <p>the Volume you restore the backup onto will get the name of the originally backed up Volume. For example if you did a Backup of <em>MyNewStorage</em>, then restored this backup onto the Volume <em>MySecondStorage</em>, the volume <em>MySecondStorage</em> will be renamed to <em>MyNewStorage</em> (however the original <em>ID</em> of the Volume will be kept).</p>
  </li>
</ul>


				</div>

<p>Backups take space in your object store, so you may want to delete old Snapshots every now and then with:</p>

<p><code>openstack backup delete &lt;Backup-ID&gt;</code></p>

<p><strong>2. Snapshot a volume and re-create it</strong></p>

<p>Before taking a snapshot, you should make sure that your volume is detached from any instance: It has to be in in “<em>available</em>” status. You can check this with</p>

<p><code>openstack volume list</code></p>

<p>To create a Snapshot of a volume:</p>

<p><code>openstack snapshot create --name &lt;Snapshot-Name&gt; --description "Describe the snapshot" &lt;Volume-Name&gt;</code></p>

<p>As the volume name you may specify the name or ID. You should name and describe the snapshot such that it makes sense to you.
Let’s for example create a snapshot of <em>MyNewStorage</em> and name it <em>MyNewStorageSnapshot1</em>:</p>

<p><code>openstack snapshot create --name MyNewStorageSnapshot1 --description "First snapshot" MyNewStorage</code></p>

<p>Now, you should be able to see your Snapshot in the list:</p>

<p><code>openstack snapshot list</code></p>

<p>Take note of the <em>ID</em> of your snapshot, you will need it to restore the snapshot state.</p>

<div class="bgInfo">
					<img src="/images/glyphicons-196-circle-info.png" alt="image" align="left" style="width:26px; height:26px; 
						margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>When you want to restore the state of the snapshot, you need to create a <em>new</em> volume — it is not possible to restore the state onto an existing volume, as it can be done with a Backup.</p>

				</div>

<p>You can create a <em>new</em> volume of this snapshot using the same command as described earlier to create a volume, but adding the <code>--snapshot</code> argument to specify the ID (the <em>Name</em> will not work) of your snapshot.</p>

<p><code>openstack volume create --snapshot &lt;snapshot-ID&gt; --description "My restored Volume" --size &lt;Size-in-GB&gt; [--availability-zone &lt;zone&gt;] &lt;New-Volume-Name&gt;</code></p>

<p>You may create a Volume which has a larger storage size than the original Snapshot, but you cannot create one with less.</p>

<p>For example, we can create a new volume out of the snapshot <em>MyNewStorageSnapshot1</em> and call it <em>MyRestoredVolume</em>, and set the size to 2GB as follows:</p>

<p><code>openstack volume create --snapshot &lt;ID of MyNewStorageSnapshot1&gt; --description "My restored Volume" --size 2 MyRestoredVolume</code></p>

<div class="bgImportant">
					<img src="/images/glyphicons-197-circle-exclamation-mark.png" alt="image" align="left" style="width:26px; height:26px; 
					  margin:0px; margin-right:10px; margin-bottom:5px;" />
					
<p>The original Volume on which the Snapshot was based <em>must still exist</em>, or the Snapshots of it become useless.</p>

<p>OpenStack does not let you delete Volumes which have “depending Snapshots”, so losing Snapshots by accidentally deleting a Volume is not a worry. However you have to be aware that the Snapshots are only usable while you keep your Volume in existence. This is different to <em>Backups</em>.</p>

				</div>

<p>The new volume will now be listed with your other volumes:</p>

<p><code>openstack volume list</code></p>

<div class="bgTerminal"><pre class="PreformatTerminal">+------------------------+------------------+-----------+------+-------------+
| ID                     | Display Name     | Status    | Size | Attached to |
+------------------------+------------------+-----------+------+-------------+
| 9f8af2bd-d5d4-45d4-... | MyRestoredVolume | available |    2 |             |
| 80cec22c-8c0c-4bd4-... | MyNewStorage     | available |    1 |             |
+------------------------+------------------+-----------+------+-------------+</pre></div>

<p>Snapshots take a good amount of your storage capacity, because they have the same size as the volume that was snapshotted. So you may want to delete old Snapshots every now and then:</p>

<p><code>openstack snapshot delete &lt;Snapshot Name&gt;</code></p>

<h2 id="tracking-utilization">Tracking utilization</h2>

<p>On the Dashboard, you can see the amount of resources you are using. You can also see how long your instances have been up and running.</p>

<p><img src="images/dashboardUtilization.png" alt="image alt text" /></p>

<p>You may want to <em>monitor</em> your virtual machine(s), i.e. keep track of CPU usage, memory usage, etc. You may also want to set up system alerts. The Dashboard does not provide any tools to do this; you will have to use tools for virtual machine <em>monitoring</em>. 
Because the NeCTAR cloud uses OpenStack to manage the cloud, we require a monitoring tool which is compatible with OpenStack.</p>

<p>OpenStack has a tool called <em>Ceilometer</em> which collects measurements within OpenStack. <em>Ceilometer</em> is actively developed and is now an integrated part of OpenStack. The Ceilometer project is a framework for <strong>monitoring and metering</strong> the OpenStack cloud.</p>

<p>Ceilometer is a service offered by OpenStack which you can query via the command line. 
It collects and monitors <em>performance</em> and <em>usage</em> data:</p>

<ul>
  <li>
    <p>Compute resources (e.g. CPU, Memory use, number of instances used)</p>
  </li>
  <li>
    <p>Network activity, including data transfer (in/out) by location.</p>
  </li>
  <li>
    <p>Storage (including object storage and volumes).</p>
  </li>
</ul>

<p>Ceilometer commands require installation of the client package. Given you have already used the <em>openstack</em> command in the previous sections, all you need to do is</p>

<p><code>pip install python-ceilometerclient</code></p>

<p>or if you haven’t used <em>pip</em> but your Linux package manager, install the client with your package manager as well, e.g. on Debian/Ubuntu:</p>

<p><code>sudo apt-get install python-ceilometerclient</code></p>

<p>You will also need to <em>source</em> your OpenStack RC file as described <a href="openstackClients.html">earlier</a>.</p>

<p>If you haven’t installed any OpenStack command line clients, follow instructions described <a href="openstackClients.html">earlier</a> and replace <em>openstackclient</em> with <em>ceilometerclient</em>.</p>

<p>Detailed instructions on how to use <em>ceilometer</em> is out of scope of this tutorial.
You can read up on the ceilometer command line reference in the <a href="http://docs.openstack.org/developer/ceilometer/">official OpenStack documentation</a> and <a href="http://docs.openstack.org/cli-reference/content/ceilometerclient_commands.html">command line reference</a>. Good documentation and useful links are also given on the <a href="http://support.rc.nectar.org.au/docs/ceilometer">NeCTAR support website</a> and in <a href="https://www.rdoproject.org/CeilometerQuickStart">this good introductory article</a>.</p>

<h2 id="summary">Summary</h2>

<p><strong>Congratulations!!</strong></p>

<p>You have completed the last module of this course. You now know how to fully control your NeCTAR resources via the command line. In particular, you have learned how to:</p>

<ul>
  <li>Install OpenStack command line clients</li>
  <li>Launch and terminate an instance</li>
  <li>Take snapshots of instances and relaunch them from snapshots</li>
  <li>Create and delete volumes</li>
  <li>Make backups and take snapshots of volumes</li>
  <li>Access the object store</li>
  <li>Track utilization</li>
</ul>

<p>We hope you have enjoyed this course. You are fully prepared to get started with using the NeCTAR Research Cloud for your research!</p>

<p>Don’t hesitate to contact <a href="http://support.rc.nectar.org.au/docs/getting-support">NeCTAR support</a> if you have any further questions on how to set up and use the NeCTAR services.</p>


      </div>
    </div>
  </body>

</html>
